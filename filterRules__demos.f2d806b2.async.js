"use strict";(self.webpackChunkdt_react_component=self.webpackChunkdt_react_component||[]).push([[1268],{77625:function(_n,j,n){n.r(j);var S=n(90554),f=n.n(S),Q=n(28870),Z=n(86516),Y=n.n(Z),W=n(83345),H=n.n(W),p=n(50425),k=n(48651),y=n.n(k),N=n(79685),$=n(50576),V=n.n($),G=n(19576),A=n(63342),I={input:""},s={key:V()(),level:0,formValues:y()({},I)},v=function(T){var M=T.input,r=T.rowKey,m=T.onChange;return(0,A.jsx)(p.default,{value:M,onChange:function(R){return m==null?void 0:m(r!=null?r:"",{input:R.target.value})}})};j.default=function(){var O=(0,N.useState)(s),T=Y()(O,2),M=T[0],r=T[1];return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(G.ZP,{component:(0,A.jsx)(v,{}),value:M,onChange:function(U){return r(U)}}),(0,A.jsx)(Q.default,{onClick:function(){return console.log(M)},children:"\u63A7\u5236\u53F0\u67E5\u770B\u6570\u636E"})]})}},1809:function(_n,j,n){n.r(j);var S=n(90554),f=n.n(S),Q=n(28870),Z=n(99764),Y=n.n(Z),W=n(9923),H=n(86516),p=n.n(H),k=n(83345),y=n.n(k),N=n(50425),$=n(48651),V=n.n($),G=n(79685),A=n(50576),I=n.n(A),s=n(19576),v=n(63342),O={input:""},T={key:I()(),level:0,formValues:V()({},O)},M=function(m){var U=m.input,R=m.rowKey,C=m.isEdit,t=m.onChange;return(0,v.jsx)(N.default,{value:U,onChange:function(i){return t==null?void 0:t(R!=null?R:"",{input:i.target.value})},disabled:!C})};j.default=function(){var r=W.Z.useForm(),m=p()(r,1),U=m[0],R=(0,G.useState)(!0),C=p()(R,2),t=C[0],D=C[1];return(0,G.useEffect)(function(){U.setFieldsValue({condition:T})},[]),(0,v.jsxs)(W.Z,{form:U,children:[(0,v.jsxs)(Q.default,{style:{marginBottom:16},onClick:function(){return D(!t)},children:[t?"\u67E5\u770B":"\u7F16\u8F91","\u72B6\u6001"]}),(0,v.jsx)(W.Z.Item,{name:"condition",children:(0,v.jsx)(s.ZP,{component:(0,v.jsx)(M,{}),isEdit:t})})]})}},95789:function(_n,j,n){n.r(j);var S=n(22786),f=n.n(S),Q=n(46299),Z=n.n(Q),Y=n(90554),W=n.n(Y),H=n(28870),p=n(99764),k=n.n(p),y=n(9923),N=n(86516),$=n.n(N),V=n(83345),G=n.n(V),A=n(50425),I=n(48651),s=n.n(I),v=n(79685),O=n(50576),T=n.n(O),M=n(19576),r=n(63342),m={input:""},U={key:T()(),level:0,formValues:s()({},m)},R=function(t){var D=t.input,i=t.rowKey,x=t.onChange;return(0,r.jsx)(A.default,{value:D,onChange:function(w){return x==null?void 0:x(i!=null?i:"",{input:w.target.value})}})};j.default=function(){var C=y.Z.useForm(),t=$()(C,1),D=t[0];return(0,r.jsxs)(y.Z,{form:D,children:[(0,r.jsx)(H.default,{onClick:function(){return D.setFieldsValue({condition:U})},style:{marginBottom:16},children:"\u6DFB\u52A0\u6570\u636E"}),(0,r.jsx)(y.Z.Item,{name:"condition",children:(0,r.jsx)(M.ZP,{component:(0,r.jsx)(R,{})})}),(0,r.jsx)(H.default,{onClick:Z()(f()().mark(function i(){return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=console,h.next=3,D.validateFields();case 3:return h.t1=h.sent,h.abrupt("return",h.t0.log.call(h.t0,h.t1));case 5:case"end":return h.stop()}},i)})),children:"\u63A7\u5236\u53F0\u67E5\u770B\u6570\u636E"})]})}},19576:function(_n,j,n){n.d(j,{de:function(){return r},NZ:function(){return m},ZP:function(){return R}});var S=n(48651),f=n.n(S),Q=n(71089),Z=n(75020),Y=n(5677),W=n.n(Y),H=n(79685),p=n(97207),k=n(50576),y=n.n(k),N=n(70300),$=n.n(N),V=n(79595),G=n(971),A=n(68591),I=n.n(A),s=n(63342),v=32,O=16,T=function(t){var D=t.value,i=t.isEdit,x=t.maxLevel,h=t.component,w=t.onAddCondition,nn=t.onDeleteCondition,ln=t.onChangeCondition,X=t.onChangeFormValues,q=function(l){return(l==null?void 0:l.type)&&[r.AND,r.OR].includes(l==null?void 0:l.type)},E=function F(l,B){if(!(l!=null&&l.children))return f()(f()({},l),{},{height:v+O,lineHeight:v});l.children=l.children.map(function(b){return F(b,B)});var K=!l.children.some(q),L=q(l.children[0]);if(B)if(l.height=l.children.reduce(function(b,g){return b+(g==null?void 0:g.height)},v),K){var c,e=((c=l.children[0])===null||c===void 0?void 0:c.height)-O,o=v;l.lineHeight=l.height-e/2-o/2}else{var _,u=L?l.children[0].lineHeight/2+v/2:v/2+O;l.lineHeight=u+((_=l.children)===null||_===void 0?void 0:_.slice(1).reduce(function(b,g){return b+(g==null?void 0:g.height)},v/2))}else if(l.height=l.children.reduce(function(b,g){return b+(g==null?void 0:g.height)},0),K)l.lineHeight=l.height-v-O;else{var d,P=l.children[0],a=l.children[l.children.length-1],J=(P==null?void 0:P.height)-z(l,!0),rn=q(a),en=z(l,!1),an=(a==null?void 0:a.height)-O-en;l.bottom=rn?en:v/2,l.lineHeight=J+((d=l.children)===null||d===void 0?void 0:d.slice(1,-1).reduce(function(b,g){return b+g.height},0))+an}return l},z=function F(l,B){var K,L,c,e=B?l==null||(K=l.children)===null||K===void 0?void 0:K[0]:l==null||(L=l.children)===null||L===void 0?void 0:L[(l==null||(c=l.children)===null||c===void 0?void 0:c.length)-1];if(!e)return v/2;var o=q(e);return o?(e==null?void 0:e.lineHeight)/2+F(e,B):v/2},on=function F(l,B,K){var L;if(l!=null&&(L=l.children)!==null&&L!==void 0&&L.length){var c,e=function(_){var u=$()(B);return u.push.apply(u,["children",_,"formValues"]),u};return(0,s.jsxs)("div",{className:I()("ruleController__condition",{"ruleController__condition--active":l.children.length>1}),children:[(0,s.jsxs)("div",{className:I()("condition__box",{disabled:!i}),style:{height:l.lineHeight,bottom:(c=l==null?void 0:l.bottom)!==null&&c!==void 0?c:O},children:[(0,s.jsx)("span",{className:I()("condition__box--name",{disabled:!i}),onClick:function(){return ln(l.key,l==null?void 0:l.type)},children:m[l==null?void 0:l.type]}),l.children.length>1&&(0,s.jsx)("span",{className:I()("condition__box--line",{disabled:!i})})]}),l.children.map(function(o,_){return F(o,e(_),K)}),i&&(0,s.jsxs)("div",{className:"condition__add",children:[(0,s.jsx)("span",{className:"condition__add--line"}),(0,s.jsx)(V.Z,{className:"condition__add--icon",onClick:function(){return w({key:l.key,isOut:!0})}})]})]},l.key)}return(0,s.jsxs)("div",{className:"ruleController__item",id:l.key,children:[(D==null?void 0:D.children)&&(0,s.jsx)("span",{className:I()("ruleController__item--line",{disabled:!i})}),(0,s.jsx)("div",{className:"ruleController__item--component",children:H.cloneElement(h,f()(f()({rowKey:l.key,isEdit:i,name:B},l.formValues),{},{onChange:X}))}),i&&(0,s.jsxs)("div",{className:"ruleController__item--operation",children:[l.level===x?null:(0,s.jsx)(V.Z,{className:"icon",onClick:function(){w({key:l.key})}}),(0,s.jsx)(G.Z,{className:"icon",onClick:function(){return nn(l.key)}})]})]})};if(!D)return null;var tn=E((0,p.cloneDeep)(D),!!i);return(0,s.jsx)("div",{className:"ruleController",children:on(tn,[],!i)})},M,r=function(C){return C[C.AND=1]="AND",C[C.OR=2]="OR",C}({}),m=(M={},W()(M,r.AND,"\u4E14"),W()(M,r.OR,"\u6216"),M),U=function(t){var D=t.component,i=t.maxLevel,x=i===void 0?5:i,h=t.isEdit,w=h===void 0?!0:h,nn=t.notEmpty,ln=nn===void 0?!0:nn,X=t.value,q=t.initRowValues,E=t.onChange,z=function c(e,o,_){var u,d=e;if(d.key===o)return d;if(!((u=d.children)!==null&&u!==void 0&&u.length))return null;for(var P=0;P<d.children.length;P++){var a=d.children[P];if(a.key===o)return _?a:d;var J=c(a,o,_);if(J)return J}},on=function(e){var o=(0,p.clone)(X),_=z(o,e.key,e.isOut);tn(_,e,q),E==null||E(o)},tn=function(e,o,_){var u=o.key;if(o.isOut)return e.children.push(Object.assign({},{formValues:_},{key:y()(),level:e.level}));var d=e==null?void 0:e.children;if(!d){var P={key:e.key,level:e.level+1,type:r.AND,children:[{formValues:e.formValues,key:y()(),level:(e==null?void 0:e.level)+1},{formValues:_,key:y()(),level:(e==null?void 0:e.level)+1}]};delete e.formValues,Object.assign(e,P);return}for(var a=0;a<d.length;a+=1)d[a].key===u&&(e==null?void 0:e.level)<=x&&(d[a]={key:d[a].key,type:r.AND,level:(e==null?void 0:e.level)+1,children:[Object.assign({},d[a],{key:y()(),level:(e==null?void 0:e.level)+1}),Object.assign({},{formValues:_},{key:y()(),level:(e==null?void 0:e.level)+1})]})},F=function(e){var o=(0,p.clone)(X),_=z(o,e,!1);if(ln&&!(_!=null&&_.children))return Z.default.info("\u5FC5\u987B\u6709\u4E00\u6761\u6570\u636E");if(!ln&&!(_!=null&&_.children))return E==null?void 0:E(void 0);l(_,e),E==null||E(o)},l=function(e,o){var _,u,d,P,a=e;if(a.children=(_=a)===null||_===void 0||(u=_.children)===null||u===void 0?void 0:u.filter(function(en){return en.key!==o}),((d=a)===null||d===void 0||(P=d.children)===null||P===void 0?void 0:P.length)===1){var J=B(a.children[0]),rn=a.key;delete a.children,delete a.type,a=Object.assign(a,f()(f()({},J),{},{key:rn,level:J.level}))}},B=function c(e){var o;e.children&&(o=e.children.map(function(u){return c(u)}));var _=f()(f()({},e),{},{children:o,level:(e==null?void 0:e.level)-1});return _},K=function(e,o){var _=(0,p.clone)(X),u=z(_,e,!0);u.type=o===r.AND?r.OR:r.AND,E==null||E(_)},L=function(e,o){var _,u=(0,p.clone)(X),d=z(u,e,!0);d.formValues=f()(f()({},(_=d.formValues)!==null&&_!==void 0?_:{}),o),E==null||E(u)};return(0,s.jsx)(T,{maxLevel:x,isEdit:w,value:X,component:D,onAddCondition:on,onDeleteCondition:F,onChangeCondition:K,onChangeFormValues:L})},R=U}}]);
