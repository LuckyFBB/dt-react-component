"use strict";(self.webpackChunkdt_react_component=self.webpackChunkdt_react_component||[]).push([[1268],{77625:function(tn,j,n){n.r(j);var $=n(90554),y=n.n($),k=n(28870),H=n(86516),w=n.n(H),K=n(83345),q=n.n(K),A=n(50425),G=n(48651),T=n.n(G),nn=n(79685),B=n(50576),x=n.n(B),X=n(19576),p=n(63342),I={input:""},v={key:x()(),level:0,rowValues:T()({},I)},u=function(a){var b=a.rowValues.input,O=a.key,r=a.onChange;return(0,p.jsx)(A.default,{value:b,onChange:function(R){return r==null?void 0:r(O!=null?O:"",{input:R.target.value})}})};j.default=function(){var M=(0,nn.useState)(v),a=w()(M,2),b=a[0],O=a[1];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(X.ZP,{component:function(c){return(0,p.jsx)(u,T()({},c))},value:b,onChange:function(c){return O(c)}}),(0,p.jsx)(k.default,{onClick:function(){return console.log(b)},children:"\u63A7\u5236\u53F0\u67E5\u770B\u6570\u636E"})]})}},1809:function(tn,j,n){n.r(j);var $=n(90554),y=n.n($),k=n(28870),H=n(99764),w=n.n(H),K=n(9923),q=n(86516),A=n.n(q),G=n(83345),T=n.n(G),nn=n(50425),B=n(48651),x=n.n(B),X=n(79685),p=n(50576),I=n.n(p),v=n(19576),u=n(63342),M={input:""},a={key:I()(),level:0,rowValues:x()({},M)},b=function(r){var c=r.rowValues.input,R=r.key,S=r.disabled,E=r.onChange;return(0,u.jsx)(nn.default,{value:c,onChange:function(C){return E==null?void 0:E(R!=null?R:"",{input:C.target.value})},disabled:S})};j.default=function(){var O=K.Z.useForm(),r=A()(O,1),c=r[0],R=(0,X.useState)(!1),S=A()(R,2),E=S[0],s=S[1];return(0,X.useEffect)(function(){c.setFieldsValue({condition:a})},[]),(0,u.jsxs)(K.Z,{form:c,children:[(0,u.jsxs)(k.default,{style:{marginBottom:16},onClick:function(){return s(!E)},children:[E?"\u7F16\u8F91":"\u67E5\u770B","\u72B6\u6001"]}),(0,u.jsx)(K.Z.Item,{name:"condition",children:(0,u.jsx)(v.ZP,{component:function(P){return(0,u.jsx)(b,x()({},P))},disabled:E})})]})}},95789:function(tn,j,n){n.r(j);var $=n(22786),y=n.n($),k=n(46299),H=n.n(k),w=n(90554),K=n.n(w),q=n(28870),A=n(86516),G=n.n(A),T=n(99764),nn=n.n(T),B=n(9923),x=n(83345),X=n.n(x),p=n(50425),I=n(70300),v=n.n(I),u=n(48651),M=n.n(u),a=n(79685),b=n(50576),O=n.n(b),r=n(19576),c=n(63342),R={input:""},S={key:O()(),level:0,rowValues:M()({},R)},E=function(C){var P=C.name;return(0,c.jsx)(B.Z.Item,{name:["condition"].concat(v()(P),["input"]),children:(0,c.jsx)(p.default,{})})};j.default=function(){var s=B.Z.useForm(),C=G()(s,1),P=C[0];return(0,c.jsxs)(B.Z,{form:P,children:[(0,c.jsx)(q.default,{onClick:function(){return P.setFieldsValue({condition:S})},style:{marginBottom:16},children:"\u6DFB\u52A0\u6570\u636E"}),(0,c.jsx)(B.Z.Item,{name:"condition",children:(0,c.jsx)(r.ZP,{component:function(z){return(0,c.jsx)(E,M()({},z))}})}),(0,c.jsx)(q.default,{onClick:H()(y()().mark(function Z(){return y()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.t0=console,f.next=3,P.validateFields();case 3:return f.t1=f.sent,f.abrupt("return",f.t0.log.call(f.t0,f.t1));case 5:case"end":return f.stop()}},Z)})),children:"\u63A7\u5236\u53F0\u67E5\u770B\u6570\u636E"})]})}},19576:function(tn,j,n){n.d(j,{de:function(){return r},NZ:function(){return c},ZP:function(){return S}});var $=n(48651),y=n.n($),k=n(71089),H=n(75020),w=n(5677),K=n.n(w),q=n(79685),A=n(97207),G=n(50576),T=n.n(G),nn=n(70300),B=n.n(nn),x=n(79595),X=n(971),p=n(68591),I=n.n(p),v=n(63342),u=32,M=16,a=new WeakMap,b=function(s){var C=s.value,P=s.disabled,Z=s.maxLevel,z=s.component,f=s.onAddCondition,en=s.onDeleteCondition,ln=s.onChangeCondition,J=s.onChangeRowValues,_n=function(_){return(_==null?void 0:_.type)&&[r.AND,r.OR].includes(_==null?void 0:_.type)},h=function N(_,U){if(!(_!=null&&_.children))return a.set(_,{height:u+M,lineHeight:u});_.children.map(function(F){return N(F,U)});var D=!_.children.some(_n),L=_n(_.children[0]);if(U){var t=_.children.reduce(function(F,Y){return F+a.get(Y).height},0),g,d;if(D)g=t-u-M;else{var V,an=_.children[0],on=_.children[_.children.length-1],un=a.get(an).height-Q(_,!0),sn=_n(on),dn=Q(_,!1),vn=a.get(on).height-M-dn;d=sn?dn:u/2,g=un+((V=_.children)===null||V===void 0?void 0:V.slice(1,-1).reduce(function(F,Y){return F+a.get(Y).height},0))+vn}a.set(_,{bottom:d,lineHeight:g,height:t})}else{var W=_.children.reduce(function(F,Y){return F+a.get(Y).height},u),m;if(D){var e=a.get(_.children[0]).height-M,o=u;m=W-e/2-o/2}else{var l,i=L?a.get(_.children[0]).lineHeight/2+u/2:u/2+M;m=i+((l=_.children)===null||l===void 0?void 0:l.slice(1).reduce(function(F,Y){return F+a.get(Y).height},u/2))}a.set(_,{height:W,lineHeight:m})}return _},Q=function N(_,U){var D,L,W,m=U?_==null||(D=_.children)===null||D===void 0?void 0:D[0]:_==null||(L=_.children)===null||L===void 0?void 0:L[(_==null||(W=_.children)===null||W===void 0?void 0:W.length)-1];if(!m)return u/2;var e=_n(m);if(e){var o;return((o=a.get(m))===null||o===void 0?void 0:o.lineHeight)/2+N(m,U)}return u/2},rn=function N(_,U,D){var L;if(_!=null&&(L=_.children)!==null&&L!==void 0&&L.length){var W=function(i){var t=B()(U);return t.push.apply(t,["children",i,"rowValues"]),t},m=a.get(_),e=m.lineHeight,o=m.bottom;return(0,v.jsxs)("div",{className:I()("ruleController__condition",{"ruleController__condition--active":_.children.length>1}),children:[(0,v.jsxs)("div",{className:I()("condition__box",{disabled:D}),style:{height:e,bottom:o!=null?o:M},children:[(0,v.jsx)("span",{className:I()("condition__box--name",{disabled:D}),onClick:function(){return ln(_.key,_==null?void 0:_.type)},children:c[_==null?void 0:_.type]}),_.children.length>1&&(0,v.jsx)("span",{className:I()("condition__box--line",{disabled:D})})]}),_.children.map(function(l,i){return N(l,W(i),D)}),!D&&(0,v.jsxs)("div",{className:"condition__add",children:[(0,v.jsx)("span",{className:"condition__add--line"}),(0,v.jsx)(x.Z,{className:"condition__add--icon",onClick:function(){return f({key:_.key,isOut:!0})}})]})]},_.key)}return(0,v.jsxs)("div",{className:"ruleController__item",children:[(C==null?void 0:C.children)&&(0,v.jsx)("span",{className:I()("ruleController__item--line",{disabled:D})}),(0,v.jsx)("div",{className:"ruleController__item--component",children:z({key:_.key,disabled:D,name:U.length?U:["rowValues"],rowValues:_.rowValues,onChange:J})}),!D&&(0,v.jsxs)("div",{className:"ruleController__item--operation",children:[_.level===Z?null:(0,v.jsx)(x.Z,{className:"icon",onClick:function(){f({key:_.key})}}),(0,v.jsx)(X.Z,{className:"icon",onClick:function(){return en(_.key)}})]})]},_.key)};return C?(h(C,!!P),(0,v.jsx)("div",{className:"ruleController",children:rn(C,[],!!P)})):null},O,r=function(E){return E[E.AND=1]="AND",E[E.OR=2]="OR",E}({}),c=(O={},K()(O,r.AND,"\u4E14"),K()(O,r.OR,"\u6216"),O),R=function(s){var C=s.component,P=s.maxLevel,Z=P===void 0?5:P,z=s.disabled,f=z===void 0?!1:z,en=s.notEmpty,ln=en===void 0?!0:en,J=s.value,_n=s.initRowValues,h=s.onChange,Q=function m(e,o,l){var i,t=e;if(t.key===o)return t;if(!((i=t.children)!==null&&i!==void 0&&i.length))return null;for(var g=0;g<t.children.length;g++){var d=t.children[g];if(d.key===o)return l?d:t;var V=m(d,o,l);if(V)return V}},rn=function(e){var o=(0,A.clone)(J),l=Q(o,e.key,e.isOut);N(l,e,_n),h==null||h(o)},N=function(e,o,l){var i=o.key;if(o.isOut)return e.children.push(Object.assign({},{rowValues:l},{key:T()(),level:e.level}));var t=e==null?void 0:e.children;if(!t){var g={key:e.key,level:e.level+1,type:r.AND,children:[{rowValues:e.rowValues,key:T()(),level:(e==null?void 0:e.level)+1},{rowValues:l,key:T()(),level:(e==null?void 0:e.level)+1}]};delete e.rowValues,Object.assign(e,g);return}for(var d=0;d<t.length;d+=1)t[d].key===i&&(e==null?void 0:e.level)<=Z&&(t[d]={key:t[d].key,type:r.AND,level:(e==null?void 0:e.level)+1,children:[Object.assign({},t[d],{key:T()(),level:(e==null?void 0:e.level)+1}),Object.assign({},{rowValues:l},{key:T()(),level:(e==null?void 0:e.level)+1})]})},_=function(e){var o=(0,A.clone)(J),l=Q(o,e,!1);if(ln&&!(l!=null&&l.children))return H.default.info("\u5FC5\u987B\u6709\u4E00\u6761\u6570\u636E");if(!ln&&!(l!=null&&l.children))return h==null?void 0:h(void 0);U(l,e),h==null||h(o)},U=function(e,o){var l,i,t,g,d=e;if(d.children=(l=d)===null||l===void 0||(i=l.children)===null||i===void 0?void 0:i.filter(function(on){return on.key!==o}),((t=d)===null||t===void 0||(g=t.children)===null||g===void 0?void 0:g.length)===1){var V=D(d.children[0]),an=d.key;delete d.children,delete d.type,d=Object.assign(d,y()(y()({},V),{},{key:an,level:V.level}))}},D=function m(e){var o;e.children&&(o=e.children.map(function(i){return m(i)}));var l=y()(y()({},e),{},{children:o,level:(e==null?void 0:e.level)-1});return l},L=function(e,o){var l=(0,A.clone)(J),i=Q(l,e,!0);i.type=o===r.AND?r.OR:r.AND,h==null||h(l)},W=function(e,o){var l,i=(0,A.clone)(J),t=Q(i,e,!0);t.rowValues=y()(y()({},(l=t.rowValues)!==null&&l!==void 0?l:{}),o),h==null||h(i)};return(0,v.jsx)(b,{maxLevel:Z,disabled:f,value:J,component:C,onAddCondition:rn,onDeleteCondition:_,onChangeCondition:L,onChangeRowValues:W})},S=R}}]);
